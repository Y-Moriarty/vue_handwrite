<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vue</title>
  </head>
  <body>
    <div id="app" style="color: red; font-size: 20px">
      hello{{msg}}
      <h1>å¼ ä¸‰</h1>
      <h2>{{a.b}}</h2>
      <h3>{{arr}}</h3>
      <h4>{{b}}</h4>
      <h4>{{fullName}}</h4>
    </div>
    <script src="dist/vue.js"></script>
    <script>
      // å…¨å±€çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å…ˆäºè‡ªå®šä¹‰çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°æ‰§è¡Œ
      // Vue.Mixin({
      //   created: function a() {
      //     console.log('a')
      //   }
      // })
      // Vue.Mixin({
      //   created: function b() {
      //     console.log('b')
      //   }
      // })

      // umd Vue
      // console.log(Vue)
      // å“åº”å¼ vue2
      // new Vue æ—¶å¯¹ä¼ å…¥å¯¹è±¡çš„æ‰€æœ‰å†…å®¹è¿›è¡Œåˆå§‹åŒ–
      let vm = new Vue({
        el: '#app',
        data() {
          // console.log(this) // å¦‚æœ initState ä¸ä½¿ç”¨ call() -> window
          return {
            msg: 'hello2',
            a: { b: 20 },
            list: [1, 2, 3],
            arr: [
              {
                a: 1
              }
            ],
            b: 200,
            firstName: 'å¼ ',
            lastName: 'ä¸‰'
          }
        },
        // data: {
        //   msg: 'hello'
        // },
        props: {},
        watch: {
          // a(newVal, oldVal) {
          //   console.log('watch')
          // },
          'a.b'(newVal, oldVal) {
            console.log('watch a.b')
          },
          b: {
            handler() {
              console.log('handler')
            },
            immediate: true
          }
        },

        // ...
        created() {
          console.log('created')
        },
        updated() {
          console.log('updated')
        },
        // å…·æœ‰ç¼“å­˜æœºåˆ¶ï¼Œæ•°æ®ç›–æ¿æ‰ä¼šé‡æ–°æ‰§è¡Œè¿™ä¸ªæ–¹æ³•
        computed: {
          fullName() {
            console.log('fullName')
            return this.firstName + this.lastName
          }
        }
      })
      // .$mount("#app") // ä½œç”¨å’Œ el ä¸€æ ·

      // ç¬¬ä¸€æ¬¡ï¼šå®ä¾‹è·å–åˆ° computed å±æ€§ï¼Œé€šè¿‡ Object.defineProperty()
      vm.fullName // get
      console.log('ğŸš€ ~ vm.fullName:', vm.fullName)
      // ç¬¬äºŒæ¬¡ï¼šé€šè¿‡ç¼“å­˜æœºåˆ¶è·å–
      vm.fullName

      // console.log("vm: ", vm);
      // console.log("vm set: ", (vm._data.msg = 100));
      // console.log("vm: ", vm._data.msg);
      // console.log('vm._data: ', vm._data)
      // console.log("vm list: ", vm._data.list.push(4, 5));
      // console.log("vm push: ", vm._data.arr.push({ a: 4, b: 5 }));
      // console.log("vm arr: ", vm.arr);
      // console.log("vm.msg: ", (vm.msg = 100));

      // setTimeout(() => {
      //   vm.msg = 'world'
      //   // æ‰‹åŠ¨è§¦å‘æ›´æ–°ï¼Œé‡æ–°èµ°ä¸€éæ¨¡æ¿ç¼–è¯‘
      //   vm._update(vm._render())
      // }, 1000)
      // * ä¸€ã€å®ç°è‡ªåŠ¨æ›´æ–°
      // 1. æ•°æ®å˜åŒ–ï¼Œè‡ªåŠ¨æ›´æ–°è§†å›¾ vm._update(vm._render())
      // 2. vue çš„æ›´æ–°ç­–ç•¥ï¼šä»¥ç»„ä»¶ä¸ºå•ä½ï¼Œç»™æ¯ä¸€ä¸ªç»„ä»¶æ·»åŠ ä¸€ä¸ª watcherï¼Œå½“å±æ€§å˜åŒ–æ—¶ï¼Œè°ƒç”¨ watcher
      // console.log(vm)
      setTimeout(() => {
        // è‡ªåŠ¨æ›´æ–° - å°† vm._update(vm._render()) å°è£…æˆå‡½æ•°ï¼Œåœ¨æ•°æ®æ›´æ–°æ—¶è°ƒç”¨
        // æ­¤æ—¶æ¯ä¸€æ¬¡æ›´æ–°éƒ½ä¼šè°ƒç”¨ vm._update(vm._render()) - æ€§èƒ½å¼€é”€å¤§
        // è§£å†³ï¼šä½¿ç”¨é˜Ÿåˆ—(nextTick) - æ‰¹é‡å¤„ç† - å¤šæ¬¡æ•°æ®æ›´æ–°ï¼Œåªè°ƒç”¨ä¸€æ¬¡ vm._update(vm._render())
        //  å¼‚æ­¥å¤„ç† - æ•°æ®æ›´æ–°åï¼Œä¸ä¼šç«‹å³æ‰§è¡Œ
        //  - watcher.js çš„ update()
        vm.msg = 'world'
        vm.arr.push({ a: 4, b: 5 })
        // vm.$nextTick(() => {
        //   // æ•°æ®æ›´æ–°åï¼Œè·å–åˆ°æœ€æ–°çš„ dom
        //   console.log('ğŸš€ ~ vm.$nextTick ~ vm.$el.innerHTML:', vm.$el.innerHTML)
        // })
        vm.b = 300
        vm.a.b = 500
        vm.firstName = 'æ'
        console.log('ğŸš€ ~ nextTick ~ vm.fullName:', vm.fullName)
      }, 1000)

      // * äºŒã€å®ç°å¯¹è±¡æ”¶é›†ä¾èµ–
      // dep å’Œ watcher å…³ç³» - å¤šå¯¹å¤š

      // * ä¸‰ã€æ•°ç»„æ”¶é›†
      // æ€è·¯ï¼š
      // 1. ç»™æ‰€æœ‰å¯¹è±¡ç±»å‹å¢åŠ ä¸€ä¸ª dep
      // 2. è·å–æ•°ç»„çš„å€¼ï¼Œä¼šè°ƒç”¨ get æ–¹æ³•æ—¶è®©å½“å‰æ•°ç»„è®°ä½è¿™ä¸ª watcher
      //  2.1 éœ€è¦è·å–åˆ°å½“å‰ dep
      //  2.2 é¢å¯¹æ•°ç»„å–å€¼çš„æ—¶å€™ï¼Œè®©æ•°ç»„çš„ dep è®°ä½è¿™ä¸ª wathcer
      // 3. å½“æ›´æ–°æ•°ç»„çš„æ—¶å€™ï¼Œæ‰¾åˆ°è¿™ä¸ª watcher è¿›è¡Œæ›´æ–°

      // * é¢è¯•é¢˜ï¼š
      // Vue åˆæ¬¡æ¸²æŸ“
      //  åˆå§‹åŒ–æ•°æ® =>å°†æ¨¡æ¿è¿›è¡Œç¼–è¯‘ => Vue æ¨¡æ¿ç¼–è¯‘ï¼ˆel å¿…é¡»è¦æœ‰ï¼‰=> å¾—åˆ° render å‡½æ•° => ç”Ÿæˆè™šæ‹ŸèŠ‚ç‚¹ => è½¬å˜ä¸ºçœŸå® DOM => æ”¾åˆ°é¡µé¢ä¸Š
      // æ¨¡æ¿ç¼–è¯‘çš„ä¸‰ç§æ–¹å¼ï¼šrender -> template -> el(é€šè¿‡ el è·å–å…ƒç´ )
      // æŸ¥çœ‹å®˜ç½‘ç”Ÿå‘½å‘¨æœŸå›¾ç¤º

      // æ‰‹å†™ vue çš„éš¾ç‚¹
      // 1. æ¨¡æ¿ç¼–è¯‘
      // 2. æ•°æ®ä¾èµ–
      // 3. ç”Ÿå‘½å‘¨æœŸ

      // Vue ç”Ÿå‘½å‘¨æœŸçš„å®ç°åŸç†
      // 1. Vue.Mixin({}) - æ··å…¥
      // 2. ç”Ÿå‘½å‘¨æœŸå…¶å®æ˜¯ä¸€ç§åŸºäºè®¢é˜…å‘å¸ƒçš„è®¾è®¡æ¨¡å¼ï¼Œå°† new Vue() ä¼ å…¥çš„å¯¹è±¡å­˜å…¥ options

      // * diff ç®—æ³• - æœ€å°æ›´æ–°(å¯¹æ¯”)ç®—æ³•
      // å¯¹æ¯”çš„æ˜¯è™šæ‹Ÿ DOM
      // 1. åˆ›å»ºä¸¤ä¸ª vNode
      // 2. å¯¹æ¯”ï¼šåœ¨æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼Œæ‹¿åˆ°æ—§èŠ‚ç‚¹å’Œæ–°èŠ‚ç‚¹ï¼Œè¿›è¡Œå¯¹æ¯”ï¼Œå°†ä¸åŒçš„åœ°æ–¹è¿›è¡Œæ›´æ–°

      // * computed é¢è¯•é¢˜
      // watch å’Œ computed çš„åŒºåˆ«
      // computed å…·æœ‰ç¼“å­˜æœºåˆ¶ï¼Œé€šè¿‡å˜é‡ dirty è¿›è¡Œæ ‡è¯†
      // watch ä¸å…·æœ‰ç¼“å­˜æœºåˆ¶
      // - é—®é¢˜ï¼šåœ¨è§†å›¾ä¸­ï¼Œæ›´æ–°æ•°æ® fullName æ²¡æœ‰æ•ˆæœ
      // å› ä¸ºè¿™é‡Œæœ‰å¤šä¸ª watcherï¼Œé¡ºåºï¼šæ¸²æŸ“ watcher -> computed watcher
      // å½“è®¡ç®—å±æ€§è®¡ç®—å®Œæˆåï¼Œéœ€è¦ä½¿ç”¨æ¸²æŸ“ watcher æ›´æ–°è§†å›¾ - å› æ­¤ è®¡ç®—å±æ€§ wathcer éœ€è¦è®°ä½ æ¸²æŸ“ watcher
    </script>
  </body>
</html>
